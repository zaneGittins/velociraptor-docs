<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.92.0">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Basic VQL :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1642491999 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1642491999 rel=stylesheet>
<link href=/css/featherlight.min.css?1642491999 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1642491999 rel=stylesheet>
<link href=/css/auto-complete.css?1642491999 rel=stylesheet>
<link href=/css/theme.css?1642491999 rel=stylesheet>
<link href=/css/tabs.css?1642491999 rel=stylesheet>
<link href=/css/hugo-theme.css?1642491999 rel=stylesheet>
<link href=/css/theme-mine.css?1642491999 rel=stylesheet>
<link href=/css/dark.css?1642491999 rel=stylesheet><link href=/css/syntax.css?1642491999 rel=stylesheet><link href=/css/light.css?1642491999 rel=stylesheet><link href=/css/hljs.css?1642491999 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1642491999 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1642491999></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYH72LMYCS',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYH72LMYCS','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script></script>
</head>
<body data-url=/vql_reference/basic/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a>
</div>
</li>
</ul>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item parent haschildren">
<div>
<i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class="dd-item parent active">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_auscert/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_auscert/>Auscert 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_osdfc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_osdfc/>OSDFC 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_blueteam_village/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_blueteam_village/>BTV 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/scudette/velociraptor-docs/edit/master/content/vql_reference/basic/_index.md target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Basic VQL
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#array>array</a></li>
<li><a href=#atexit>atexit</a></li>
<li><a href=#atoi>atoi</a></li>
<li><a href=#base64decode>base64decode</a></li>
<li><a href=#base64encode>base64encode</a></li>
<li><a href=#basename>basename</a></li>
<li><a href=#batch>batch</a></li>
<li><a href=#cache>cache</a></li>
<li><a href=#column_filter>column_filter</a></li>
<li><a href=#copy>copy</a></li>
<li><a href=#count>count</a></li>
<li><a href=#dict>dict</a></li>
<li><a href=#dirname>dirname</a></li>
<li><a href=#encode>encode</a></li>
<li><a href=#enumerate>enumerate</a></li>
<li><a href=#environ>environ</a></li>
<li><a href=#expand>expand</a></li>
<li><a href=#filter>filter</a></li>
<li><a href=#format>format</a></li>
<li><a href=#generate>generate</a></li>
<li><a href=#get>get</a>
<ul>
<li><a href=#example>Example</a></li>
</ul>
</li>
<li><a href=#getpid>getpid</a></li>
<li><a href=#humanize>humanize</a></li>
<li><a href=#if>if</a></li>
<li><a href=#items>items</a></li>
<li><a href=#items-1>items</a>
<ul>
<li><a href=#iterating-dicts>Iterating dicts</a></li>
<li><a href=#iterating-queries>Iterating queries</a></li>
</ul>
</li>
<li><a href=#join>join</a></li>
<li><a href=#killkillkill>killkillkill</a></li>
<li><a href=#len>len</a></li>
<li><a href=#log>log</a></li>
<li><a href=#lowcase>lowcase</a></li>
<li><a href=#max>max</a>
<ul>
<li><a href=#example-1>Example</a></li>
</ul>
</li>
<li><a href=#memoize>memoize</a></li>
<li><a href=#min>min</a>
<ul>
<li><a href=#example-2>Example</a></li>
</ul>
</li>
<li><a href=#now>now</a></li>
<li><a href=#path_join>path_join</a></li>
<li><a href=#path_split>path_split</a></li>
<li><a href=#query>query</a></li>
<li><a href=#rand>rand</a></li>
<li><a href=#range>range</a></li>
<li><a href=#read_file>read_file</a></li>
<li><a href=#regex_transform>regex_transform</a></li>
<li><a href=#relpath>relpath</a></li>
<li><a href=#scope>scope</a></li>
<li><a href=#serialize>serialize</a></li>
<li><a href=#set>set</a></li>
<li><a href=#sleep>sleep</a></li>
<li><a href=#slice>slice</a></li>
<li><a href=#split>split</a></li>
<li><a href=#str>str</a></li>
<li><a href=#strip>strip</a></li>
<li><a href=#substr>substr</a></li>
<li><a href=#sum>sum</a></li>
<li><a href=#tempdir>tempdir</a></li>
<li><a href=#timestamp>timestamp</a></li>
<li><a href=#to_dict>to_dict</a>
<ul>
<li><a href=#notes>Notes</a></li>
<li><a href=#example-3>Example</a></li>
</ul>
</li>
<li><a href=#unhex>unhex</a></li>
<li><a href=#unzip>unzip</a></li>
<li><a href=#upcase>upcase</a></li>
<li><a href=#upload_sftp>upload_sftp</a></li>
<li><a href=#upload_webdav>upload_webdav</a></li>
<li><a href=#url>url</a></li>
<li><a href=#utf16>utf16</a></li>
<li><a href=#utf16_encode>utf16_encode</a></li>
<li><a href=#uuid>uuid</a></li>
<li><a href=#version>version</a></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Basic VQL
</h1>
<p>VQL provides a basic set of functions and plugins allowing
queries to manipulate data and implement logic. This page details
those plugins which are considered foundational to the VQL
language and therefore may be useful in all types of artifacts.</p>
<div class="mynotices note">
<div heading=note><p>VQL plugins are not the same as VQL functions. A plugin is the subject
of the VQL query - i.e. plugins always follow the <code>FROM</code> keyword,
while functions (which return a single value instead of a sequence of
rows) are only present in column specification (e.g. after <code>SELECT</code>)
or in condition clauses (i.e. after the <code>WHERE</code> keyword).</p>
</div>
</div>
<div class=vql_item></div>
<h2 id=array>array</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Create an array with all the args.</p>
<p>This function accepts arbitrary arguments and creates an array by
flattening the arguments. For example <code>array(a=1, b=2)</code> will return
<code>[1, 2]</code>.</p>
<p>You can use this to flatten a subquery as well:</p>
<pre><code class=language-sql>SELECT array(a1={ SELECT User FROM Artifact.Windows.System.Users() }) as Users FROM scope()
</code></pre>
<p>Will return a single row with Users being an array of names.</p>
<div class=vql_item></div>
<h2 id=atexit>atexit</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Install a query to run when the query is unwound. This is used to
clean up when the query ends.</p>
<p>For example:</p>
<pre><code class=language-vql>LET _ &lt;= atexit(query={
  SELECT rm(filename=&quot;Foobar.txt&quot;) FROM scope()
})
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>A VQL Query to parse and execute.</td>
<td>Any (required)</td>
</tr>
<tr>
<td>env</td>
<td>A dict of args to insert into the scope.</td>
<td>ordereddict.Dict</td>
</tr>
<tr>
<td>timeout</td>
<td>How long to wait for destructors to run (default 60 seconds).</td>
<td>uint64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=atoi>atoi</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Convert a string to an integer.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to convert to int</td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=base64decode>base64decode</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Decodes a base64 encoded string.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=base64encode>base64encode</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Encodes a string into base64.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=basename>basename</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Return the basename of the path. For example basename(path="/foo/bar") -> &ldquo;bar&rdquo;</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Extract directory name of path</td>
<td>string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>Separator to use (default /)</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=batch>batch</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Batches query rows into multiple arrays.</p>
<p>This is useful for batching multiple rows from a query into
another query (for example sending into an API endpoint). For
example:</p>
<pre><code class=language-vql>SELECT * FROM batch(query={
  SELECT _value
  FROM range(start=0, end=10, step=1)
}, batch_size=3)
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>batch_size</td>
<td>Size of batch (defaults to 10).</td>
<td>int64</td>
</tr>
<tr>
<td>batch_func</td>
<td>A VQL Lambda that determines when a batch is ready. Example &lsquo;x=>len(list=x) >= 10&rsquo;.</td>
<td>string</td>
</tr>
<tr>
<td>query</td>
<td>Run this query over the item.</td>
<td>StoredQuery (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=cache>cache</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Creates a cache object.</p>
<p>A Cache is a data structure which is used to speed up calculating
data by keeping it&rsquo;s value in memory. A cache is essentially a key
value store - when the key is accessed, the function will be
calculated producing a value. If the key is accessed again, the
value is returned from the cache without calculating it again.</p>
<p>For example consider the following:</p>
<pre><code class=language-vql>    LET get_pid_query(Lpid) =
       SELECT Pid, Ppid, Name FROM pslist(pid=Lpid)

    SELECT cache(func=get_pid_query(Lpid=Pid), key=str(str=Pid))
    FROM ....
</code></pre>
<p>The cache will ensure that get_pid_query() is only called once per
unique Pid by comparing the key against the internal memory store.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>func</td>
<td>A function to evaluate</td>
<td>LazyExpr (required)</td>
</tr>
<tr>
<td>name</td>
<td>The global name of this cache (needed when more than one)</td>
<td>string</td>
</tr>
<tr>
<td>key</td>
<td>Cache key to use.</td>
<td>string (required)</td>
</tr>
<tr>
<td>period</td>
<td>The latest age of the cache.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=column_filter>column_filter</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Select columns from another query using regex.</p>
<p>Sometimes a query produces a large number of columns or
unpredictable column names (eg. the <code>read_reg_key()</code> plugin
produces a column per value name).</p>
<p>You can use the column_filter() plugin to select a subset of the
columns to include or exclude from an underlying query. For example:</p>
<pre><code class=language-vql>SELECT * FROM column_filter(
query={
   SELECT 1 AS A, 2 AS B, 3 AS AB, 4 AS AA
   FROM scope()
}, include=&quot;A&quot;, exclude=&quot;B&quot;)
</code></pre>
<p>will include columns with the letter A in their name and remove
columns with the letter B (so it will have A and AA above).</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>This query will be run to produce the columns.</td>
<td>StoredQuery (required)</td>
</tr>
<tr>
<td>exclude</td>
<td>One of more regular expressions that will exclude columns.</td>
<td>list of string</td>
</tr>
<tr>
<td>include</td>
<td>One of more regular expressions that will include columns.</td>
<td>list of string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=copy>copy</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Copy a file.</p>
<p>The source file can use any accessor - for example one can copy
the $MFT using the ntfs accessor to a regular file. Another
example is to extract a file from a zip file using the <code>zip</code>
accessor into a file on disk.</p>
<p>This function can also be used to create new files with prescribed
content - for example:</p>
<pre><code class=language-vql>SELECT copy(filename=&quot;Hello world&quot;, accessor=&quot;data&quot;, dest=&quot;C:/hi.txt&quot;)
FROM scope()
</code></pre>
<p>NOTE: Sparse files are padded out</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>The file to copy from.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>dest</td>
<td>The destination file to write.</td>
<td>string (required)</td>
</tr>
<tr>
<td>permissions</td>
<td>Required permissions (e.g. &lsquo;x&rsquo;).</td>
<td>string</td>
</tr>
<tr>
<td>append</td>
<td>If true we append to the target file otherwise truncate it</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=count>count</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Counts the items.</p>
<p>This function is an aggregation function that counts the number of
times it is evaluated per group by context. It is useful in a
GROUP BY clause to count the number of items in each group.</p>
<p>You can also use it in a regular query to produce a row
count. NOTE: When used in this way it only counts the total number
of rows that are actually evaluated (i.e. not filtered out) due to
the lazy evaluation property of VQL columns.</p>
<p>For a full discussion of aggregate functions see
<a href=https://docs.velociraptor.app/docs/vql/#aggregate-functions>https://docs.velociraptor.app/docs/vql/#aggregate-functions</a></p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>items</td>
<td>Not used anymore</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=dict>dict</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Construct a dict from arbitrary keyword args.</p>
<p>This function creates a dictionary (a key/value map). NOTE: In VQL
dictionaries always have string keys. Sometimes key names contain
special characters like dots etc, in that case you can use
backticks to escape the name. For example:</p>
<pre><code class=language-vql>SELECT dict(Foo=&quot;Bar&quot;, `Name.With.Dots`=&quot;Baz&quot;)
FROM scope()
</code></pre>
<p>See the <code>to_dict()</code> function to create dicts from a query with
unpredictable key names.</p>
<div class=vql_item></div>
<h2 id=dirname>dirname</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Return the directory path.</p>
<p>For example direname(path="/usr/bin/ls") -> &ldquo;/usr/bin&rdquo;</p>
<p>Related: basename()</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Extract directory name of path</td>
<td>string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>Separator to use (default /)</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=encode>encode</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Encodes a string as as different type. Currently supported types include &lsquo;hex&rsquo;, &lsquo;base64&rsquo;.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td></td>
<td>Any (required)</td>
</tr>
<tr>
<td>type</td>
<td></td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=enumerate>enumerate</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Collect all the items in each group by bin.</p>
<p>This is an aggregate function that keeps track of all elements in
a GROUP BY group.</p>
<p>NOTE: Use this function carefully as memory use can be large. It
keeps a copy of every element in the group and that can be very
large for large result sets.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>items</td>
<td>Not used anymore</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=environ>environ</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Get an environment variable.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>var</td>
<td>Extract the var from the environment.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=expand>expand</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Expand the path using the environment.</p>
<p>This function expands environment variables into the path. It is
normally needed after using registry values of type REG_EXPAND_SZ as
they typically contain environment strings. Velociraptor does not
automatically expand such values since environment variables typically
depend on the specific user account which reads the registry value
(different user accounts can have different environment variables).</p>
<p>This function uses the Golang standard for expanding variables
(using $varname ). On Windows, we also support using the Windows
notation with % before and after the variable name.</p>
<pre><code class=language-vql>SELECT expand(path=&quot;My Username is %USERNAME%&quot;)
FROM scope()
</code></pre>
<p>NOTE: The environment strings are set per user and Velociraptor&rsquo;s
own environment may not reflect any other process&rsquo;s
environment. See <code>Windows.Forensics.ProcessInfo</code> for a
forensically sound manner of obtaining the environment from any
process.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>A path with environment escapes</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=filter>filter</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Filters a strings array by regex.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>list</td>
<td>A list of items to filter</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>regex</td>
<td>A regex to test each item</td>
<td>list of string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=format>format</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Format one or more items according to a format string.</p>
<p>This function is essentially a wrapper around Golang&rsquo;s
fmt.Sprintf() function and uses the same format specifiers.</p>
<p><a href=https://pkg.go.dev/fmt>https://pkg.go.dev/fmt</a></p>
<p>Of note the following are very useful:</p>
<ul>
<li>The <code>% x</code> applied on strings will hex print the string</li>
<li>The <code>%T</code> will reveal the internal type of an object.</li>
<li>The <code>%v</code> is the general purpose stringifier and can apply to strings, ints etc.</li>
</ul>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>format</td>
<td>Format string to use</td>
<td>string (required)</td>
</tr>
<tr>
<td>args</td>
<td>An array of elements to apply into the format string.</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=generate>generate</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Create a named generator that receives rows from the query.</p>
<p>This plugin allow multiple queries to efficiently filter rows from
the same query. For example:</p>
<pre><code class=language-vql>LET SystemLog = generate(query={
   SELECT * FROM parse_evtx(filename='''C:\Windows\system32\winevt\logs\System.evtx''')
})

SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp,
   Type, EventData
FROM combine(
a={
  SELECT *, &quot;Kernel Driver Install&quot; AS Type
  FROM SystemLog
  WHERE System.EventID.Value = 7045 AND EventData.ServiceType =~ &quot;kernel&quot;
}, b={
  SELECT *, &quot;Log File Cleared&quot; AS Type,
            UserData.LogFileCleared AS EventData
  FROM SystemLog
  WHERE System.EventID.Value = 104
})
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>Name to call the generator</td>
<td>string</td>
</tr>
<tr>
<td>query</td>
<td>Run this query to generator rows.</td>
<td>StoredQuery</td>
</tr>
<tr>
<td>delay</td>
<td>Wait before starting the query</td>
<td>int64</td>
</tr>
<tr>
<td>with_file_buffer</td>
<td>Enable file buffering</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=get>get</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Gets the member field from item.</p>
<p>This is useful to index an item from an array. For example:</p>
<h3 id=example>Example</h3>
<pre><code class=language-sql>select get(item=[dict(foo=3), 2, 3, 4], member='0.foo') AS Foo from scope()

[
 {
   &quot;Foo&quot;: 3
 }
]
</code></pre>
<p>Using the member parameter you can index inside a nested
dictionary using dots to separate the layers.</p>
<p>If you need to access a field with dots in its name, you can use
the field parameter which simply fetches the named field.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>member</td>
<td></td>
<td>string</td>
</tr>
<tr>
<td>field</td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>default</td>
<td></td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=getpid>getpid</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Returns the current pid of the Velociraptor process.</p>
<p>This is typically used to exclude analysis from our own process.</p>
<div class=vql_item></div>
<h2 id=humanize>humanize</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Format items in human readable way.</p>
<p>Formats a byte count in human readable way (e.g. Mb, Gb etc).</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>bytes</td>
<td>Format bytes with units</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=if>if</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Conditional execution of query</p>
<p>This function evaluates a condition. Note that the values used in the
<code>then</code> or <code>else</code> clause are evaluated lazily. They may be expressions
that involve stored queries (i.e. queries stored using the <code>LET</code>
keyword). These queries will not be evaluated if they are not needed.</p>
<p>This allows a query to cheaply branch. For example, if a parameter is
given, then perform hash or upload to the server.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>condition</td>
<td></td>
<td>Any (required)</td>
</tr>
<tr>
<td>then</td>
<td></td>
<td>LazyExpr</td>
</tr>
<tr>
<td>else</td>
<td></td>
<td>LazyExpr</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=items>items</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Iterate over dict members producing _key and _value columns</p>
<p>This can be used to filter dict items by feeding the results to
<code>to_dict()</code></p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=items-1>items</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Enumerate all members of the item (similar to Python&rsquo;s items() method).</p>
<p>This plugin allows iteration over dicts or queries.</p>
<h3 id=iterating-dicts>Iterating dicts</h3>
<p>If the item is a dict, then this plugin will iterate over its keys
and values producing two columns:</p>
<ul>
<li>The <code>_key</code> column is the dictionary key</li>
<li>The <code>_value</code> column is the dictionary value</li>
</ul>
<h3 id=iterating-queries>Iterating queries</h3>
<p>For queries or arrays, the <code>items()</code> plugin will produce two columns:</p>
<ul>
<li>The <code>_key</code> column is the row index starting from 0</li>
<li>The <code>_value</code> column is the row itself as a dict.</li>
</ul>
<p>The <code>items()</code> query is useful to treat the results of another
query as a dict instead of a row. This is useful when the query
produces unpredictable columns or you need to operate over the
column names somehow.</p>
<p>For example:</p>
<pre><code class=language-vql>SELECT * FROM items(item={ SELECT * FROM info() })
</code></pre>
<p>Produces:</p>
<pre><code class=language-json>[
  {
    &quot;_key&quot;: 0,
    &quot;_value&quot;: {
      &quot;Hostname&quot;: &quot;DESKTOP-BTI2T9T&quot;,
      &quot;Uptime&quot;: 20445,
      &quot;BootTime&quot;: 1641029930,
      &quot;Architecture&quot;: &quot;amd64&quot;
    }
  }
]
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td>The item to enumerate.</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=join>join</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Join all the args on a separator.</p>
<p>Joins the array into a string separated by the sep character.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>array</td>
<td>The array to join</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>The separator. Defaults to an empty string if not explicitly set</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=killkillkill>killkillkill</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Kills the client and forces a restart - this is very aggressive!</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td></td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=len>len</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Returns the length of an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>list</td>
<td>A list of items too filter</td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=log>log</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Log the message.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>message</td>
<td>Message to log.</td>
<td>string (required)</td>
</tr>
<tr>
<td>dedup</td>
<td>Suppress same message in this many seconds (default 60 sec).</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=lowcase>lowcase</h2>
<p><span class="vql_type pull-right">Function</span></p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to lower</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=max>max</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Finds the largest item in the aggregate.</p>
<p>It is only meaningful in a group by query.</p>
<h3 id=example-1>Example</h3>
<p>The following query lists all the processes and shows the largest
bash pid of all bash processes.</p>
<pre><code class=language-SQL>SELECT Name, max(items=Pid) as LargestPid from pslist() Where Name =~ 'bash' group by Name
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>LazyExpr (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=memoize>memoize</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Memoize a query into memory.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Query to expand into memory</td>
<td>LazyExpr (required)</td>
</tr>
<tr>
<td>key</td>
<td>The name of the column to use as a key.</td>
<td>string (required)</td>
</tr>
<tr>
<td>period</td>
<td>The latest age of the cache.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=min>min</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Finds the smallest item in the aggregate.</p>
<p>It is only meaningful in a group by query.</p>
<h3 id=example-2>Example</h3>
<p>The following query lists all the processes and shows the smallest
bash pid of all bash processes.</p>
<pre><code class=language-SQL>SELECT Name, min(items=Pid) as SmallestPid from pslist() Where Name =~ 'bash' group by Name
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>LazyExpr (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=now>now</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Returns current time in seconds since epoch.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to convert to int</td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=path_join>path_join</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Build a path by joining all components.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>components</td>
<td>Path components to join.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>Separator to use (default /)</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=path_split>path_split</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Split a path into components. Note this is more complex than just split() because it takes into account path escaping.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Path to split into components.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=query>query</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Launch a subquery and materialize it into a list of rows.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>vql</td>
<td></td>
<td>StoredQuery (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=rand>rand</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Selects a random number.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>range</td>
<td>Selects a random number up to this range.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=range>range</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Iterate over range.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>Start index (0 based)</td>
<td>int64 (required)</td>
</tr>
<tr>
<td>end</td>
<td>End index (0 based)</td>
<td>int64 (required)</td>
</tr>
<tr>
<td>step</td>
<td>End index (0 based)</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=read_file>read_file</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Read a file into a string.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>length</td>
<td>Max length of the file to read.</td>
<td>int</td>
</tr>
<tr>
<td>offset</td>
<td>Where to read from the file.</td>
<td>int64</td>
</tr>
<tr>
<td>filename</td>
<td>One or more files to open.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>An accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=regex_transform>regex_transform</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Search and replace a string with multiple regex. Note you can use $1
to replace the capture string.</p>
<pre><code class=language-vql>SELECT regex_transform(source=&quot;Hello world&quot;, map=dict(
   `^Hello`=&quot;Goodbye&quot;,
   `world`=&quot;Space&quot;), key=&quot;A&quot;)
FROM scope()
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>source</td>
<td>The source string to replace.</td>
<td>string (required)</td>
</tr>
<tr>
<td>map</td>
<td>A dict with keys reg, values substitutions.</td>
<td>ordereddict.Dict (required)</td>
</tr>
<tr>
<td>key</td>
<td>A key for caching</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=relpath>relpath</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Return the relative path of .</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Extract directory name of path</td>
<td>string (required)</td>
</tr>
<tr>
<td>base</td>
<td>The base of the path</td>
<td>string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>Separator to use (default native)</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=scope>scope</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>return the scope.</p>
<div class=vql_item></div>
<h2 id=serialize>serialize</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Encode an object as a string (csv or json).</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td>The item to encode</td>
<td>Any (required)</td>
</tr>
<tr>
<td>format</td>
<td>Encoding format (csv,json,yaml,hex,base64)</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=set>set</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Sets the member field of the item. If item is omitted sets the scope.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>Any (required)</td>
</tr>
<tr>
<td>field</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>value</td>
<td></td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=sleep>sleep</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Sleep for the specified number of seconds. Always returns true.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>The number of seconds to sleep</td>
<td>int64</td>
</tr>
<tr>
<td>ms</td>
<td>The number of ms to sleep</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=slice>slice</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Slice an array.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>list</td>
<td>A list of items to slice</td>
<td>Any (required)</td>
</tr>
<tr>
<td>start</td>
<td>Start index (0 based)</td>
<td>uint64 (required)</td>
</tr>
<tr>
<td>end</td>
<td>End index (0 based)</td>
<td>uint64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=split>split</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Splits a string into an array based on a regexp separator.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>The value to split</td>
<td>string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>The separator that will be used to split</td>
<td>string</td>
</tr>
<tr>
<td>sep_string</td>
<td>The separator as string that will be used to split</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=str>str</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Normalize a String.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>str</td>
<td>The string to normalize</td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=strip>strip</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Strip a prefix from a string.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>The string to strip</td>
<td>string (required)</td>
</tr>
<tr>
<td>prefix</td>
<td>The prefix to strip</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=substr>substr</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Create a substring from a string</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>str</td>
<td>The string to shorten</td>
<td>string (required)</td>
</tr>
<tr>
<td>start</td>
<td>Beginning index of substring</td>
<td>int</td>
</tr>
<tr>
<td>end</td>
<td>End index of substring</td>
<td>int</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=sum>sum</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Sums the items.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=tempdir>tempdir</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Create a temporary directory. The directory will be removed when the query ends.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>remove_last</td>
<td>If set we delay removal as much as possible.</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=timestamp>timestamp</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Convert from different types to a time.Time.</p>
<p>This is one of the most important functions in VQL. We need to
convert timestamps very frequently from various
representations. Most commonly from strings, Unix epoch times etc.</p>
<p>This function is pretty smart and tries to do the right thing most
of the time automatically. For example, you can provide the epoch
parameter as an integer representing seconds since the epoch,
milliseconds or microseconds since the epoch.</p>
<pre><code class=language-vql>SELECT timestamp(epoch=1630414425) AS Time1,
       timestamp(epoch=1630414425000) AS Time2,
       timestamp(epoch=1630414425000000) AS Time3,
FROM scope()
</code></pre>
<p>You can also provide a string, and <code>timestamp()</code> will try to parse
it by guessing what it represents. For example</p>
<pre><code>SELECT timestamp(string='March 3 2019'),
       timestamp(string='07/25/2019 5pm')
FROM scope()
</code></pre>
<p>For more control over the parsing of strings, use the <code>format</code>
parameter to specify a template which will be used to parse the
timestamp.</p>
<p>The format template uses a constant time as an example of how the
time is layed out. It represents a template for a timestamp that
<strong>must</strong> use the following date constants</p>
<ul>
<li>Year: &ldquo;2006&rdquo; &ldquo;06&rdquo;</li>
<li>Month: &ldquo;Jan&rdquo; &ldquo;January&rdquo;</li>
<li>Textual day of the week: &ldquo;Mon&rdquo; &ldquo;Monday&rdquo;</li>
<li>Numeric day of the month: &ldquo;2&rdquo; &ldquo;_2&rdquo; &ldquo;02&rdquo;</li>
<li>Numeric day of the year: &ldquo;__2&rdquo; &ldquo;002&rdquo;</li>
<li>Hour: &ldquo;15&rdquo; &ldquo;3&rdquo; &ldquo;03&rdquo; (PM or AM)</li>
<li>Minute: &ldquo;4&rdquo; &ldquo;04&rdquo;</li>
<li>Second: &ldquo;5&rdquo; &ldquo;05&rdquo;</li>
<li>AM/PM mark: &ldquo;PM&rdquo;</li>
<li>&ldquo;-0700&rdquo; hhmm</li>
<li>&ldquo;-07:00&rdquo; hh:mm</li>
<li>&ldquo;-07&rdquo; hh</li>
</ul>
<pre><code class=language-vql>SELECT timestamp(string=&quot;8/30/2021 6:01:28 PM&quot;,
                 format=&quot;1/2/2006 3:04:05 PM&quot;)
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>epoch</td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>cocoatime</td>
<td></td>
<td>int64</td>
</tr>
<tr>
<td>mactime</td>
<td>HFS+</td>
<td>int64</td>
</tr>
<tr>
<td>winfiletime</td>
<td></td>
<td>int64</td>
</tr>
<tr>
<td>string</td>
<td>Guess a timestamp from a string</td>
<td>string</td>
</tr>
<tr>
<td>timezone</td>
<td>A default timezone (UTC)</td>
<td>string</td>
</tr>
<tr>
<td>format</td>
<td>A format specifier as per the Golang time.Parse</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=to_dict>to_dict</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Construct a dict from a query.</p>
<p>Sometimes we need to build a dict object where both the names of
the keys and their values are not known in advance - they are
calculated from another query. In this case we can use the
to_dict() function to build a dict from a query. The query needs
to emits as many rows as needed with a column called <code>_key</code> and
one called <code>_value</code>. The <code>to_dict()</code> will then construct a dict
from this query.</p>
<h3 id=notes>Notes</h3>
<ol>
<li>
<p>In VQL all dicts are ordered, so the order in which rows appear
in the query will determine the dict&rsquo;s key order.</p>
</li>
<li>
<p>VQL dicts always have string keys, if the <code>_key</code> value is not a
string the row will be ignored.</p>
</li>
</ol>
<h3 id=example-3>Example</h3>
<p>The following (rather silly) example creates a dict mapping Pid to
ProcessNames in order to cache Pid->Name lookups. We then resolve
Pid to Name within other queries. Note the use of &lt;= to
materialize the dict into memory once.</p>
<pre><code class=language-vql>LET PidLookup &lt;= to_dict(item={
    SELECT str(str=Pid) AS _key, Name AS _value
    FROM pslist()
})

SELECT Pid, get(item=PidLookup, field=str(str=Pid))
FROM pslist()
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=unhex>unhex</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Apply hex decoding to the string.</p>
<p>A hex encoded string consists of two hex digits per byte -
therefore valid hex encoded strings have an even length.</p>
<p>For example: &ldquo;01230F0a&rdquo;</p>
<p>Note: If you need to encode a string as hex encoded string you can
use the format function:</p>
<pre><code class=language-vql>format(format=&quot;%02x&quot;, args=&quot;Hello&quot;) -&gt; &quot;48656c6c6f&quot;
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>Hex string to decode</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=unzip>unzip</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Unzips a file into a directory</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>File to unzip.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>filename_filter</td>
<td>Only extract members matching this filter.</td>
<td>string</td>
</tr>
<tr>
<td>output_directory</td>
<td>Where to unzip to</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upcase>upcase</h2>
<p><span class="vql_type pull-right">Function</span></p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to lower</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upload_sftp>upload_sftp</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Upload files to SFTP.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>The file to upload</td>
<td>string (required)</td>
</tr>
<tr>
<td>name</td>
<td>The name of the file that should be stored on the server (may contain the path)</td>
<td>string</td>
</tr>
<tr>
<td>user</td>
<td>The username to connect to the endpoint with</td>
<td>string (required)</td>
</tr>
<tr>
<td>path</td>
<td>Path on server to upload file to (will be prepended to name)</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>privatekey</td>
<td>The private key to use</td>
<td>string (required)</td>
</tr>
<tr>
<td>endpoint</td>
<td>The Endpoint to use including port number (e.g. 192.168.1.1:22 )</td>
<td>string (required)</td>
</tr>
<tr>
<td>hostkey</td>
<td>Host key to verify. Blank to disable</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upload_webdav>upload_webdav</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Upload files to a WebDAV server.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>The file to upload</td>
<td>string (required)</td>
</tr>
<tr>
<td>name</td>
<td>The name that the file should have on the server</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>url</td>
<td>The WebDAV url</td>
<td>string (required)</td>
</tr>
<tr>
<td>basic_auth_user</td>
<td>The username to use in HTTP basic auth</td>
<td>string</td>
</tr>
<tr>
<td>basic_auth_password</td>
<td>The password to use in HTTP basic auth</td>
<td>string</td>
</tr>
<tr>
<td>noverifycert</td>
<td>Skip TLS Verification</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=url>url</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Construct a URL or parse one.</p>
<p>This function parses or constructs URLs. A URL may be constructed from
scratch by providing all the components or it may be parsed from an
existing URL.</p>
<p>The returned object is a <a href=https://golang.org/pkg/net/url/#URL>golang
URL</a> and can be serialized again
using its <code>String</code> method.</p>
<p>This function is important when constructing parameters for certain
accessors which receive a URL. For example the <code>zip</code> accessor requires
its file names to consist of URLs. The Zip accessor interprets the URL
in the following way:</p>
<ul>
<li>The scheme is the delegate accessor to use.</li>
<li>The path is the delegate accessor&rsquo;s filename</li>
<li>The fragment is used by the zip accessor to retrieve the zip member itself.</li>
</ul>
<p>In this case it is critical to properly escape each level - it is not
possible in the general case to simply append strings. You need to use
the <code>url()</code> function to build the proper url.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>scheme</td>
<td>The scheme to use</td>
<td>string</td>
</tr>
<tr>
<td>host</td>
<td>The host component</td>
<td>string</td>
</tr>
<tr>
<td>path</td>
<td>The path component</td>
<td>string</td>
</tr>
<tr>
<td>fragment</td>
<td>The fragment</td>
<td>string</td>
</tr>
<tr>
<td>parse</td>
<td>A url to parse</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=utf16>utf16</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse input from utf16.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=utf16_encode>utf16_encode</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Encode a string to utf16 bytes.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to decode</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=uuid>uuid</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Generate a UUID.</p>
<div class=vql_item></div>
<h2 id=version>version</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Gets the version of a VQL plugin or function.</p>
<p>This is useful when writing portable VQL which can work with
older versions of Velociraptor. When Velociraptor plugins evolve
in an incompatible way their version is incremented. It is
possible to cater for multiple versions in the VQL using an if()
plugin.</p>
<p>For example the following can chose from a legacy query or a
modern query based on the plugin version:</p>
<pre><code> SELECT * FROM if(
  condition=version(plugin=&quot;glob&quot;) &gt;= 1,
  then=NewQuery,
  else=LegacyQuery)
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>function</td>
<td></td>
<td>string</td>
</tr>
<tr>
<td>plugin</td>
<td></td>
<td>string</td>
</tr>
</tbody>
</table>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1642491999></script>
<script src=/js/perfect-scrollbar.min.js?1642491999></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1642491999></script>
<script src=/js/jquery.sticky.js?1642491999></script>
<script src=/js/featherlight.min.js?1642491999></script>
<script src=/js/highlight.min.js?1642491999></script>
<script>hljs.highlightAll()</script>
<script src=/js/modernizr.custom-3.6.0.js?1642491999></script>
<script src=/js/learn.js?1642491999></script>
<script src=/js/hugo-learn.js?1642491999></script>
</body>
</html>