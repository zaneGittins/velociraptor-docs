<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.89.1">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Evidence Of Execution :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1636298361 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1636298361 rel=stylesheet>
<link href=/css/featherlight.min.css?1636298361 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1636298361 rel=stylesheet>
<link href=/css/auto-complete.css?1636298361 rel=stylesheet>
<link href=/css/theme.css?1636298361 rel=stylesheet>
<link href=/css/tabs.css?1636298361 rel=stylesheet>
<link href=/css/hugo-theme.css?1636298361 rel=stylesheet>
<link href=/css/theme-mine.css?1636298361 rel=stylesheet>
<link href=/css/dark.css?1636298361 rel=stylesheet><link href=/css/syntax.css?1636298361 rel=stylesheet><link href=/css/light.css?1636298361 rel=stylesheet><link href=/css/hljs.css?1636298361 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1636298361 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1636298361></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYH72LMYCS',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYH72LMYCS','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script></script>
</head>
<body data-url=/docs/forensic/evidence_of_execution/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item parent haschildren">
<div>
<i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item parent haschildren">
<div>
<i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class="dd-item parent active">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a>
</div>
</li>
</ul>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brough to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/scudette/velociraptor-docs/edit/master/content/docs/forensic/evidence_of_execution/_index.md target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Evidence Of Execution
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#prefetch-files>Prefetch files</a></li>
<li><a href=#prefetch-tips>Prefetch tips</a></li>
<li><a href=#prefetch-timeline>Prefetch timeline</a></li>
<li><a href=#background-activity-moderator>Background Activity Moderator</a></li>
<li><a href=#shim-cache>Shim cache</a></li>
<li><a href=#amcache>Amcache</a></li>
<li><a href=#system-resource-usage-monitor-srum>System Resource Usage Monitor (SRUM)</a></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Evidence Of Execution
</h1>
<div class="author pull-right">
<span class=date>2021-06-27</span>
</div>
<p>Sometimes we need to find out when (or if) a particular binary was run
on the endpoint. This question can come up in a number of contexts,
such as running malware by a user, lateral movement from a threat
actor etc.</p>
<p>Windows has a rich set of forensic artifacts that we can use to infer
program execution. This page covers some of the more common evidence
of execution artifacts.</p>
<h2 id=prefetch-files>Prefetch files</h2>
<p>Prefetch files are used to <a href=http://web.archive.org/web/20130315214654/http://windows.microsoft.com:80/en-US/windows7/What-is-the-prefetch-folder>keep track of executions</a></p>
<blockquote>
<p>What is the prefetch folder?</p>
<p>Each time you turn on your computer,
Windows keeps track of the way your computer starts and which
programs you commonly open. Windows saves this information as a
number of small files in the prefetch folder. The next time you turn
on your computer, Windows refers to these files to help speed the
start process.</p>
</blockquote>
<p>You can see those prefetch files in the <code>C:\Windows\prefetch</code> directory</p>
<p>
<figure>
<img src=image4.png alt="Prefetch files" class=captioned>
<figcaption>Prefetch files</figcaption>
</figure>
</p>
<p>Prefetch files’ name consist of the original binary and the <a href=https://www.symantec.com/connect/blogs/prefetch-analysis-live-response>hash of the application path</a>. Velociraptor has a built in Prefetch file parser, that allows extracting more information from the files themselves.</p>
<p>Prefetch files contain the following data (In recent Windows 10)</p>
<ul>
<li>The last 8 times the binary was run</li>
<li>The number of times the binary was run</li>
<li>The binary name</li>
<li>The file size</li>
</ul>
<h2 id=prefetch-tips>Prefetch tips</h2>
<p>You can try to establish the original path of the executable by <a href=https://hiddenillusion.github.io/2016/05/10/go-prefetch-yourself/>brute forcing the hash</a>. Typically the full path of the binary is also encoded as one of the linked PE files.</p>
<p>Look for particularly suspicious binaries, eg sc.exe, xcopy.exe,
psexec.exe, bitsadmin.exe and particularly random looking binary
names. Typically lower execution counts are more interesting</p>
<p>Even though the prefetch file itself only records 8 times of
execution, each time a binary is executed, the system will update the
prefetch file. It may be that other artifacts record this
interaction. In particular, the USN journal might record an
interaction with the prefetch file which is not recorded in the actual
prefetch file itself (because the binary was run more than 8 times or
the prefetch file was removed as an anti-forensic method).</p>
<p>Note too that the prefetch file creation time will record the time
when the program was <strong>first</strong> run, giving an additional timestamp to
consider.</p>
<h2 id=prefetch-timeline>Prefetch timeline</h2>
<p>The <code>Windows.Forensics.Prefetch</code> artifact shows all the execution
times for each file as an array. This is less useful as we normally
want to filter it by time of interest. The
<code>Windows.Timeline.Prefetch</code> artifact is more useful for that as it
breaks records into distinct rows that can be easily filtered by
timestamps.</p>
<p>
<figure>
<img src=image10.png alt="Prefetch files" class=captioned>
<figcaption>Prefetch files</figcaption>
</figure>
</p>
<h2 id=background-activity-moderator>Background Activity Moderator</h2>
<p>BAM is a Windows service that Controls activity of background
applications. This service exists in Windows 10 only after Fall
Creators update – <a href=https://www.andreafortuna.org/dfir/forensic-artifacts-evidences-of-program-execution-on-windows-systems/>version 1709</a>.</p>
<p>The service maintains binary data in the registry which keeps track on
the execution of different programs by the user. Velociraptor can
parse these timestamps using the <code>Windows.Forensics.Bam</code> artifact.</p>
<p>
<figure>
<img src=image30.png alt=BAM class=captioned>
<figcaption>BAM</figcaption>
</figure>
</p>
<div class="mynotices note">
<div heading=note><p>The BAM artifact is stored in the registry under a key unique to the
user SID on the system, therefore it provides valuable attribution as
to who ran the binary (which Prefetch does not provide).</p>
</div>
</div>
<h2 id=shim-cache>Shim cache</h2>
<p>Windows maintains a backward compatible set of tweaks to binaries
called “Shims”. As part of this mechanism, there is a application
compatibility database stored in the registry key</p>
<p><code>HKLM\SYSTEM\CurrentControlSet\Control\SessionManager\AppCompatibility\AppCompatCache</code></p>
<p>You can read more about the Shim cache <a href=https://www.fireeye.com/content/dam/fireeye-www/services/freeware/shimcache-whitepaper.pdf>here</a> or <a href="http://www.alex-ionescu.com/?p=39">here</a> or <a href=https://www.andreafortuna.org/2017/10/16/amcache-and-shimcache-in-forensic-analysis/>here</a>.</p>
<p>The Shim cache database tracks the executables’ file name, file size and last modified time of the binary.</p>
<p>Velociraptor can parse the shim cache using the <code>Windows.Registry.AppCompatCache</code> artifact.</p>
<div class="mynotices note">
<div heading=note><p>Note this is the modification time of the binary from the NTFS $STANDARD_INFORMATION stream, which might be replicated by the installer - so it might even be before the system was installed.</p>
</div>
</div>
<h2 id=amcache>Amcache</h2>
<p>The Windows Application Experience Service tracks process creation
data in a registry file located in
<code>C:\Windows\AppCompat\Programs\Amcache.hve</code></p>
<p>This tracks the first execution of a program on the system, including
programs executed from an external storage. You can investigate the
Amcache hive using the <code>Windows.System.Amcache</code> artifact.</p>
<p>Unlike the other registry based artifacts above, this registry hive is
not mounted and accessible via the Windows APIs - the service simply
uses the registry file format to store the information. We therefore
need to parse the raw registry hive file using the raw registry
accessor.</p>
<div class="mynotices note">
<div heading=note><p>Note the key location is a URL - Velociraptor uses URL notation to
access raw registry hives as described <a href=/docs/forensic/filesystem/#raw-registry-parsing>here</a>. This one uses
the ntfs file accessor to access the raw hive data since it is usually
locked at runtime.</p>
</div>
</div>
<h2 id=system-resource-usage-monitor-srum>System Resource Usage Monitor (SRUM)</h2>
<p>Windows keeps a running count of application metrics using SRUM in
order to power the &ldquo;App history&rdquo; tab in the task manager.</p>
<p>
<figure>
<img src=image12.png alt=SRUM class=captioned>
<figcaption>SRUM</figcaption>
</figure>
</p>
<p>Metrics are stored in an ESE database at the location <code>%windir%\System32\sru\SRUDB.dat</code>. You can read more about the SRUM <a href=https://www.velocidex.com/blog/medium/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/>here</a>.</p>
<p>You can examine the ESE database manually using Nirsoft <a href=https://www.nirsoft.net/utils/ese_database_view.html>ESEDatabaseViewer</a>.</p>
<p>
<figure>
<img src=image16.png alt=SRUM class=captioned>
<figcaption>SRUM</figcaption>
</figure>
</p>
<p>The database contains multiple tables named after the GUID of the SRUM
extension that is recording data. While not all tables are fully
understood or documented it is sometimes possible to work out what
information is recorded by simple inspection of the database tables.</p>
<p>Velociraptor already knows how to interpret some of the providers:</p>
<ul>
<li><code>{D10CA2FE-6FCF-4F6D-848E-B2E99266FA89}</code> is for application resource usage.</li>
<li><code>{DD6636C4-8929-4683-974E-22C046A43763}</code> is for network connection stats</li>
</ul>
<p>You can collect the SRUM database using the <code>Windows.Forensics.SRUM</code>
artifact. The artifact contains several sources, each attempting to
interpret a different provider table.</p>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1636298361></script>
<script src=/js/perfect-scrollbar.min.js?1636298361></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1636298361></script>
<script src=/js/jquery.sticky.js?1636298361></script>
<script src=/js/featherlight.min.js?1636298361></script>
<script src=/js/highlight.min.js?1636298361></script>
<script>hljs.highlightAll()</script>
<script src=/js/modernizr.custom-3.6.0.js?1636298361></script>
<script src=/js/learn.js?1636298361></script>
<script src=/js/hugo-learn.js?1636298361></script>
</body>
</html>