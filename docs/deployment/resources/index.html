<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.102.3"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Performance :: Velociraptor - Digging deeper!</title><link href=/css/nucleus.css?1662542554 rel=stylesheet><link href=/css/fontawesome-all.min.css?1662542554 rel=stylesheet><link href=/css/featherlight.min.css?1662542554 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1662542554 rel=stylesheet><link href=/css/auto-complete.css?1662542554 rel=stylesheet><link href=/css/theme.css?1662542554 rel=stylesheet><link href=/css/tabs.css?1662542554 rel=stylesheet><link href=/css/hugo-theme.css?1662542554 rel=stylesheet><link href=/css/theme-mine.css?1662542554 rel=stylesheet><link href=/css/dark.css?1662542554 rel=stylesheet><link href=/css/syntax.css?1662542554 rel=stylesheet><link href=/css/light.css?1662542554 rel=stylesheet><link href=/css/hljs.css?1662542554 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1662542554 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1662542554></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-QYH72LMYCS","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script></script></head><body data-url=/docs/deployment/resources/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/2022-velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2022-velocon/>2022 VeloCon</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class="dd-item active"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2021_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_auscert/>Auscert 2021</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2021_osdfc/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_osdfc/>OSDFC 2021</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2021_blueteam_village/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_blueteam_village/>BTV 2021</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_us/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_us/>DFRWS US 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_tech_user_group_cbr/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_tech_user_group_cbr/>Tech Users Group 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2022</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/docs/deployment/resources/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Performance</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#idle-performance>Idle performance</a></li><li><a href=#heavy-hunting>Heavy hunting</a><ul><li><a href=#managing-concurrency>Managing concurrency</a></li><li><a href=#disk-space>Disk space</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Performance</h1><p>With the present architecture, Velociraptor only supports a file based
data store. This makes it easy to deploy as you don&rsquo;t need to set up
an elaborate database backend, but this is inherently limited to a
single machine.</p><p>We expect this limitation to be removed in the near future but until
then, people are often asking us about how to spec the server and how
many endpoints Velociraptor can support in its current form.</p><p>In this page we discuss some of the performance limitations of the
platform. It is important to understand how performance affects the
framework and how Velociraptor manages finite resources to scale up
efficiently.</p><p>The following discussion is fairly technical and goes into a lot of
specific implementation details.</p><h2 id=idle-performance>Idle performance</h2><p>One of the important considerations is how many resources are used by
an idle deployment - i.e. one at which clients are simply connected to
the server but no active hunts or collections are run from them. It is
important to note that even when clients are idle, Velociraptor always
collects endpoint footprint telemetry by sampling Velociraptor&rsquo;s own
CPU and Memory footprint every 10 seconds on each endpoint.</p><p>We typically deploy on AWS a <code>t2.large</code> (8Gb 2 core VM) to support up
to 10k endpoints. Below is a deployment we have that is mostly idle.
CPU load is in the range 10-20% of one core, memory &lt; 400mb when
idle. This is a typical medium sized deployment of around 2.5k
endpoints. Load typically increases linearly - so a 5,000 endpoint
deployment might use twice the CPU load etc. For 20,000 endpoint
deployment a larger size VM would be required.</p><p><figure><img src=idle.png alt="Idle performance statistics" class=captioned><figcaption>Idle performance statistics</figcaption></figure></p><p>When idle, the main CPU load is with RSA operations for encrypting and
decrypting messages to the endpoint. Since each endpoint selects an
ephemeral key we need to maintain an in-memory cache of session keys -
this avoids having to do a lot of RSA operations. The size of the
cache is controlled by the <code>Frontend.expected_clients</code> setting and
defaults to 10,000 endpoints. Increasing endpoints above that will
overflow the memory cache and will results in a lot more RSA
operations. The cache can be increased safely at the cost of added
memory use.</p><h2 id=heavy-hunting>Heavy hunting</h2><p>When running many hunts, the server simply collects results from the
endpoints. Due to the unique architecture of Velociraptor, all
collections are simply queries that run on the endpoints. Queries can
return a result set (essentially rows and columns of JSON encoded
values), or bulk data (e.g. for file uploads). The server simply
stores these results in the filestore.</p><p>For this reason even hunts that intuitively seem expensive are
actually very light on the server. For example, consider an artifact
that applies a Yara signature to many files on the endpoints. This
might search through many Terabytes of data collectively on all
endpoints, but if the signature is good will only report few relevant
results. In this case the load will be very small on the server
(client side load can be managed through the op/sec client side query
limiting mechanism).</p><p>On the other hand, consider a hunt that just collects a lot of data
(e.g. the <code>Windows.KapeFiles.Targets</code> artifact). This causes the
clients to send a lot of bulk data which the server needs to decrypt,
then store on the filesystem. This will lead to a lot of server load
(and will also saturate inbound bandwidth). It is easy to collect
hundreds of Gigabytes unintentionally at scale.</p><h3 id=managing-concurrency>Managing concurrency</h3><p>When receiving a lot of data from many clients simultaneously, the
Velociraptor frontend must buffer the data in memory before decrypting
and processing the data. Therefore the limiting factor is actually
memory and not CPU load. The total number of concurrent connections
determines the total memory used.</p><p>To protect itself, the frontend has a limit on the total number of
concurrent client connections. This is controlled by the
<code>Frontend.concurrency</code> setting. The default is 6 but if you have more
than 2Gb of RAM you should probably increase that to 20 or more.</p><p>The concurrency setting limits the number of clients that are allowed
to upload data to the server at the same time. Lowering this value
reduces memory use, but increases the time taken for hunts to
complete. Many hunts are not terribly urgent so this is a reasonable
trade off.</p><p>In the current version (0.4.1) there is no QoS mechanism on the
communications so while a heavy hunt is in progress, interactive
investigation (e.g. through the VFS view) can not proceed. Therefore
currently this is a disadvantage of lowering concurrency too much. We
expect the situation to change in the near future.</p><p>Typically hunts progress very quickly and do not transfer a lot of
data (Collecting large quantities of data not only leads to server
saturation, but also leaves the investigators with huge quantity of
data to post process - it is better to be more surgical in collection
and move processing to the query on the endpoints as much as possible).</p><p>The figure below shows a typical day of heavy hunting on the
deployment shown in the previous figure (about 2.5k endpoints). Each
of the CPU spikes is a hunt, and most hunts complete in a few
minutes. During the hunt CPU load rises to about 160-180% (this is a 2
core VM), but memory remains very stable due to the concurrency
controls described above.</p><p><figure><img src=hunting.png alt="Hunting performance" class=captioned><figcaption>Hunting performance</figcaption></figure></p><h3 id=disk-space>Disk space</h3><p>By far the most important aspects of specing the server is the amount
of disk space available. Since Velociraptor uses a simple filesystem
to store all its data, it is easy to manage disk space by deleting or
archiving old data.</p><div class="mynotices note"><div heading=" Disk usage "><p>It is very easy to fill up disk space with Velociraptor because it is
so fast and responsive. For example issuing a large triage file
collection for user&rsquo;s web browser related files might include on
average 500Mb of Internet cache files per client - on a 10,000 machine
deployment this will collect 5tb of data! Since Velociraptor is very
fast, if you have excellent connectivity to your endpoints, you
<strong>will</strong> fill up the disk in a matter of hours!</p><p>Always be aware of the multiplicative effect of scale. In many cases
it might require a change of mindset - if you are most familiar with
interactive &ldquo;traditional&rdquo; digital forensics it might require
re-thinking your approach when scaling up investigations and issuing
more surgical artifact collections.</p><p>If your disk fills, The Velociraptor frontend will be unable to
receive any data from endpoints (will begin serving 500
responses). Due to Velociraptor&rsquo;s architecture, clients will queue up
outgoing messages to the server in their local buffer file (by
default up to 1Gb).</p><p>This might result in a situation where after clearing the disk space,
Velociraptor will immediately fill it up again with more data queued
to be sent by the clients. If this happens you need to stop active
hunts to actively remove their results from clients&rsquo; buffer files.</p></div></div><p>The following describes the directories one typically finds in the
filestore directory:</p><ol><li><p><code>acl</code> : This contains the ACL policies for all users.</p></li><li><p><code>artifact_definitions</code>: This contains custom artifacts that were added through the GUI</p></li><li><p><code>client_index</code> and <code>clients</code>: These contains information collected
from all clients. It is possible to completely remove these
directories and restart the server. Clients will simply re-enrol
automatically.</p></li><li><p><code>config</code>: This directory contains server specific configuration
that is changed through the GUI.</p></li><li><p><code>downloads</code>: Contains Zip files prepared via the GUI&rsquo;s &ldquo;Prepare Download&rdquo; button.</p></li><li><p><code>hunt_index</code> and <code>hunt</code>: contain metadata related to managing
current hunts. It does not typically contain a lot of data.</p></li><li><p><code>journals</code> are journal files that allow Velociraptor to follow all
clients at the same time. It is safe to remove journal files at any
time as they can become large. They typically contain events from
client and server monitoring queries.</p></li><li><p><code>notebooks</code> contains the user created post processing and analysis
notebooks. You probably do not want to remove these.</p></li><li><p><code>server_artifacts</code> store the results of collection Server Artifacts
in the GUI.</p></li><li><p><code>users</code> contains information about all GUI users.</p></li></ol><p>The majority of the disk usage appears in the <code>clients</code> and <code>journals</code>
directories so it is worth aggressively managing that usage.</p><p>In the AWS cloud it is possible to resize disk space dynamically. See <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/requesting-ebs-volume-modifications.html>Requesting Modifications to Your EBS Volumes</a> and <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/recognize-expanded-volume-linux.html>Extending a Linux File System After Resizing a Volume</a>. You can do this without even restarting the server.</p><footer class=footline></footer></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//velocidex-velociraptor.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1662542554></script>
<script src=/js/perfect-scrollbar.min.js?1662542554></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1662542554></script>
<script src=/js/jquery.sticky.js?1662542554></script>
<script src=/js/featherlight.min.js?1662542554></script>
<script src=/js/highlight.min.js?1662542554></script>
<script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1662542554></script>
<script src=/js/learn.js?1662542554></script>
<script src=/js/hugo-learn.js?1662542554></script></body></html>