<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.107.0"><meta name=description content="Our latest Velociraptor release contains many new features and bug fixes. This post outlines some of the more interesting changes.
"><link rel=icon href=/images/favicon.png type=image/png><title>Velociraptor 0.6.3 Release :: Velociraptor - Digging deeper!</title><link href=/css/nucleus.css?1669826938 rel=stylesheet><link href=/css/fontawesome-all.min.css?1669826938 rel=stylesheet><link href=/css/featherlight.min.css?1669826938 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1669826938 rel=stylesheet><link href=/css/auto-complete.css?1669826938 rel=stylesheet><link href=/css/theme.css?1669826938 rel=stylesheet><link href=/css/tabs.css?1669826938 rel=stylesheet><link href=/css/hugo-theme.css?1669826938 rel=stylesheet><link href=/css/theme-mine.css?1669826938 rel=stylesheet><link href=/css/dark.css?1669826938 rel=stylesheet><link href=/css/syntax.css?1669826938 rel=stylesheet><link href=/css/light.css?1669826938 rel=stylesheet><link href=/css/hljs.css?1669826938 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1669826938 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1669826938></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-QYH72LMYCS","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script></script></head><body data-url=/blog/2022/2022-01-05-release-notes-0.6.3/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/references/>Config Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item parent haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_us/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_us/>DFRWS US 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_tech_user_group_cbr/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_tech_user_group_cbr/>Tech Users Group 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2022</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/blog/2022/2022-01-05-release-notes-0.6.3/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Velociraptor 0.6.3 Release</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#performance-running-on-efs>Performance running on EFS</a></li><li><a href=#searching-and-indexing>Searching and indexing</a></li><li><a href=#regular-expressions-and-yara-rules>Regular expressions and Yara rules</a></li><li><a href=#overriding-genericclientinfo>Overriding Generic.Client.Info</a></li><li><a href=#root-certificates-are-now-embedded>Root certificates are now embedded</a></li><li><a href=#vql-changes>VQL Changes</a><ul><li><a href=#glob-plugin-improvements>Glob plugin improvements</a></li></ul></li><li><a href=#notable-new-artifacts>Notable new artifacts</a></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/release>Release</a></div></div><div id=body-inner><h1>Velociraptor 0.6.3 Release</h1><div class="author pull-right">Mike Cohen
<span class=date>2022-01-05</span></div><p>I am very excited to announce the latest Velociraptor release
0.6.3. This release has been in the making for a few months now and
has a lot of new features.</p><p>The main focus of development since our previous release was around
scalability and speed. Working with some of our larger partners on
scaling Velociraptor to a large number of endpoints, we have addressed
a number of challenges, which I believe have improved Velociraptor for
everyone at any level of scale!</p><h2 id=performance-running-on-efs>Performance running on EFS</h2><p>Running on a distributed filesystem such as EFS presents many
advantages, not the least of which is removing the risk that disk space
will run out! Many users previously faced disk full errors when
running large hunts and accidentally collecting too much data from
endpoints! Since Velociraptor is so fast, it is easy to do a hunt
collecting a large number of files and then pretty soon the disk is
full.</p><p>Using EFS removed this risk since storage is essentially infinite (but
not free). So there is a definite advantage to running the data store
on EFS even when not running multiple frontends. When scaling to
multiple frontends, EFS use is essential to facilitate as a shared
distributed filesystem among all the servers.</p><p>However, EFS presents some challenges. Although conceptually EFS
behaves as a transparent filesystem, in reality the added network
latency of EFS IO was causing unacceptable performance issues.</p><p>In this release we employed a number of strategies to improve
performance on EFS (and potentially other distributed filesystems
e.g. NFS). You can read all about the <a href=/docs/deployment/cloud/multifrontend/>new changes here</a>, but the gist of it is
that added caching and delayed writing strategies help to isolate the
GUI performance from the underlying EFS latency, making the GUI
snappy and quick even with slow filesystems.</p><p>I encourage everyone to test the new release on an EFS backend, to
assess the performance on this setup - there are many advantages to
this configuration. While this configuration is still considered
experimental it is running successfully in a number of environments.</p><h2 id=searching-and-indexing>Searching and indexing</h2><p>More as a side effect of the EFS work, Velociraptor 0.6.3 moves the
client index into memory. This means that searching for clients by DNS
name or labels is almost instant, much improving the performance of
these operations over previous version.</p><p>VQL queries that walk over all clients, are now very fast as well. For
example the following query iterates over all clients (maybe
thousands!) and checks if their last IP came from a particular subnet:</p><pre><code class=language-vql>SELECT * , split(sep=&quot;:&quot;, string=last_ip)[0] AS LastIp
FROM clients()
WHERE cidr_contains(ip=LastIp, ranges=&quot;192.168.1.0/16&quot;)
</code></pre><p>This query will complete in a few seconds even with a large number of
clients.</p><p>The GUI search bar can now search for IP addresses
(e.g. <code>ip:192.168*</code>), and the online only filter is much faster as a
result!</p><p><figure><img src=searching.png alt="Searching is much faster" class=captioned><figcaption>Searching is much faster</figcaption></figure></p><p>Another benefit of rapid index searching is that we can now quickly
estimate how many hosts will be affected by a hunt (calculated based
on how many hosts are included and how many are excluded from the
hunt). When users have multiple label groups this helps to quickly
understand how targeted a specific hunt is.</p><p><figure><img src=hunt.png alt="Estimating hunt scope" class=captioned><figcaption>Estimating hunt scope</figcaption></figure></p><h2 id=regular-expressions-and-yara-rules>Regular expressions and Yara rules</h2><p>Velociraptor artifacts are just a way of wrapping a VQL query inside a
YAML file for ease of use. Artifacts accept parameters that are passed
to the VQL itself controlling how it runs.</p><p>Velociraptor artifacts accept a number of parameters of different
types. Sometimes, they accept a windows path - for example the
<code>Windows.EventLogs.EvtxHunter</code> artifact accepts a Windows glob path
like <code>%SystemRoot%\System32\Winevt\Logs\*.evtx</code>. In the same artifact,
we also can provide a <code>PathRegex</code> which is a regular expression.</p><p>A regular expression is not the same thing as a path at all, and in
fact when users get mixed up providing something like
<code>C:\Windows\System32</code> to a regular expression field, this is an
invalid expressions - backslashes have a specific meaning in a regular
expression!</p><p>In 0.6.3 there are now dedicated GUI elements for Regular Expression
inputs. Special regex patterns such as backslash sequences are
visually distinct. Additionally the GUI verifies that the regex is
syntactically correct and offers suggestions. Users can type <code>?</code> to
receive further regular expression suggestions and help them build
their regex.</p><p><figure><img src=regex.png alt="Entering regex in the GUI" class=captioned><figcaption>Entering regex in the GUI</figcaption></figure></p><p>To receive a RegEx GUI selector in your custom artifacts, simply
denote the parameter&rsquo;s type as <code>regex</code>.</p><p>Similarly other artifacts require the user enter a Yara rule to use
the <code>yara()</code> VQL plugin. The Yara domain specific language (DSL) is
rather verbose so even for very simple search terms (e.g. a simple
keyword search) a full rule needs to be constructed.</p><p>To help with this task, the GUI now presents a specific Yara GUI
element. Users can press <code>?</code> to automatically fill in a skeleton Yara
rule suitable for a simple keyword match. Additionally, syntax
highlighting gives visual feedback to the validity of the yara syntax.</p><p><figure><img src=yara.png alt="Entering Yara Rules in the GUI" class=captioned><figcaption>Entering Yara Rules in the GUI</figcaption></figure></p><p>Some artifacts allow file upload as a parameter to the artifact. This
allows users to upload larger inputs for example a large Yara
rule-set. The content of the file will be made available to the VQL
running on the client transparently.</p><p>To receive a RegEx GUI selector in your custom artifacts, simply
denote the parameter&rsquo;s type as <code>yara</code>. To allow uploads in your
artifact parameters simply denote the parameter as a <code>upload</code>
type. Within the VQL, the content of the uploaded file will be
available as that parameter.</p><h2 id=overriding-genericclientinfo>Overriding Generic.Client.Info</h2><p>When a new client connects to the Velociraptor server, the server
performs an <code>Interrogation</code> flow by scheduling the
<code>Generic.Client.Info</code> artifact on it. This artifact collects basic
metadata about the client such as the type of OS it is, the hostname,
the version of Velociraptor etc. This information is used to feed the
search index and is also displayed in the &ldquo;VQL drilldown&rdquo; page of the
<code>Host Information</code> screen.</p><p>In the latest release it is possible to customize the
<code>Generic.Client.Info</code> artifact and Velociraptor will use the
customized version instead to interrogate new clients. This allows
users to add more deployment specific collections to the interrogate
flow and customize the &ldquo;VQL drilldown&rdquo; page. Simply search for
<code>Generic.Client.Info</code> in the <code>View Artifact</code> screen and customize as
needed.</p><h2 id=root-certificates-are-now-embedded>Root certificates are now embedded</h2><p>By default Golang searches for root certificates from the running
system so it can verify TLS connections. This behavior caused problems
when running Velociraptor on very old unpatched systems that did not
receive the latest <a href=https://letsencrypt.org/docs/dst-root-ca-x3-expiration-september-2021/>Let&rsquo;s Encrypt Root Certificate
update</a>. We
decided it was safer to just include the root certs in the binary so
we do not need to rely on the OS itself.</p><p>Additionally Velociraptor will now accept additional root certs
embedded in its config file (Just add all the certs in PEM format
under the <code>Client.Crypto.root_certs</code> key in the config file). This
helps deployments that must use a MITM proxy or traffic inspection
proxies.</p><div class="mynotices note"><div heading=" Traffic inspection proxy "><p>When adding a Root Certificate to the configuration file, Velociraptor
will treat that certificate as part of the public PKI roots -
therefore you will need to have <code>Client.use_self_signed_ssl</code> as false.</p><p>This allows Velociraptor to trust the TLS connection - however, bear
in mind that Velociraptor&rsquo;s internal encryption channel is still
present! The MITM proxy will not be able to actually decode the data
nor can it interfere with the communications by injecting or modifying
data. Only the outer layer of TLS encryption can be stripped by the
MITM proxy.</p></div></div><h2 id=vql-changes>VQL Changes</h2><h3 id=glob-plugin-improvements>Glob plugin improvements</h3><p>The <code>glob</code> plugin now has a new option: <code>recursion_callback</code>. This
allows much finer control over which directories to visit making file
searches much more efficient and targeted. To read more about it see
<a href=/blog/2022/2022-01-05-searching-for-files-on-linux/>Searching for files</a>.</p><h2 id=notable-new-artifacts>Notable new artifacts</h2><p>Many people use Velociraptor to collect and hunt for data from
endpoints. Once the data is inspected and analyzed, often the data is
no longer needed.</p><p>To help with the task of expiring old data, the latest release
incorporates the <code>Server.Utils.DeleteManyFlows</code> and
<code>Server.Utils.DeleteMonitoringData</code> artifacts which allow users to
remove older collections. This helps to manage disk usage and reduce
ongoing costs.</p><h2 id=conclusions>Conclusions</h2><p>If you like the new features, take <a href=https://github.com/Velocidex/velociraptor>Velociraptor for a
spin</a>! It is a available
on GitHub under an open source license. As always please file issues
on the bug tracker or ask questions on our mailing list
<a href=mailto:velociraptor-discuss@googlegroups.com>velociraptor-discuss@googlegroups.com</a>
. You can also chat with us directly on discord
<a href=https://www.velocidex.com/discord>https://www.velocidex.com/discord</a>
.</p><footer class=footline></footer></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//velocidex-velociraptor.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1669826938></script>
<script src=/js/perfect-scrollbar.min.js?1669826938></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1669826938></script>
<script src=/js/jquery.sticky.js?1669826938></script>
<script src=/js/featherlight.min.js?1669826938></script>
<script src=/js/highlight.min.js?1669826938></script>
<script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1669826938></script>
<script src=/js/learn.js?1669826938></script>
<script src=/js/hugo-learn.js?1669826938></script></body></html>