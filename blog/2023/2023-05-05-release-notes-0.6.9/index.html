<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.113.0"><meta name=description content="Velociraptor Release 0.6.9 is now LIVE!
This post discusses some of the new features.
"><link rel=icon href=/images/favicon.png type=image/png><title>Velociraptor 0.6.9 Release :: Velociraptor - Digging deeper!</title><link href=/css/nucleus.css?1686138977 rel=stylesheet><link href=/css/fontawesome-all.min.css?1686138977 rel=stylesheet><link href=/css/featherlight.min.css?1686138977 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1686138977 rel=stylesheet><link href=/css/auto-complete.css?1686138977 rel=stylesheet><link href=/css/theme.css?1686138977 rel=stylesheet><link href=/css/tabs.css?1686138977 rel=stylesheet><link href=/css/hugo-theme.css?1686138977 rel=stylesheet><link href=/css/theme-mine.css?1686138977 rel=stylesheet><link href=/css/dark.css?1686138977 rel=stylesheet><link href=/css/syntax.css?1686138977 rel=stylesheet><link href=/css/light.css?1686138977 rel=stylesheet><link href=/css/hljs.css?1686138977 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1686138977 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1686138977></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-QYH72LMYCS","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script></script></head><body data-url=/blog/2023/2023-05-05-release-notes-0.6.9/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/2023-cves/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2023-cves/>Current CVEs</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/2023-trainings/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2023-trainings/>Trainings</a></div></li><li data-nav-id=https://docs.velociraptor.app/announcements/2023-velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2023-velocon/>VeloCON 2023</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/references/>Config Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item parent haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_us/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_us/>DFRWS US 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_tech_user_group_cbr/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_tech_user_group_cbr/>Tech Users Group 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_auscert/>Auscert 2023</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2022</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/blog/2023/2023-05-05-release-notes-0.6.9/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Velociraptor 0.6.9 Release</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#gui-improvements>GUI improvements</a><ul><li><a href=#table-filtering-and-sorting>Table filtering and sorting</a></li><li><a href=#vfs-gui-improvements>VFS GUI improvements</a></li><li><a href=#hex-viewer-and-file-previewer-gui>Hex viewer and file previewer GUI</a></li><li><a href=#artifact-pack-import-gui-improvements>Artifact pack import GUI improvements</a></li></ul></li><li><a href=#direct-smb-support>Direct SMB support</a><ul><li><a href=#using-smb-for-distributing-tools>Using SMB for distributing tools</a></li></ul></li><li><a href=#the-offline-collector>The offline collector</a><ul><li><a href=#smb-server-uploads>SMB server uploads</a></li><li><a href=#azure-blob-storage-service>Azure Blob storage service.</a></li></ul></li><li><a href=#debugging-vql-queries>Debugging VQL queries</a></li><li><a href=#locking-down-the-server>Locking down the server</a></li><li><a href=#audit-events>Audit events</a></li><li><a href=#tool-definitions-can-now-specify-an-expected-hash>Tool definitions can now specify an expected hash</a></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/release>Release</a></div></div><div id=body-inner><h1>Velociraptor 0.6.9 Release</h1><div class="author pull-right">Mike Cohen
<span class=date>2023-05-05</span></div><p>I am very excited to announce the latest Velociraptor release 0.6.9 is
now LIVE and available for download. This release has
been in the making for a few months now and has a lot of new features
and bug fixes.</p><p>In this post I will discuss some of the interesting new features.</p><h2 id=gui-improvements>GUI improvements</h2><p>The GUI was updated in this release to improve user workflow and accessibility.</p><h3 id=table-filtering-and-sorting>Table filtering and sorting</h3><p>Previously, table filtering and sorting required a separate dialog. In
this release the filtering controls were moved to the header of each
column making it more natural to use.</p><p><figure><img src=filtering_tables.png alt="Filtering tables." class=captioned><figcaption>Filtering tables.</figcaption></figure></p><h3 id=vfs-gui-improvements>VFS GUI improvements</h3><p>The VFS UI allows the user to collect files from the endpoint in a
familiar tree based user interface. In previous versions it was only
possible to schedule a single download at a time. This proved
problematic when the client was offline or transferring a large file
because the user had no way to kick off the next download until the
first file was fully fetched.</p><p>In this release the GUI was revamped to support multiple file
downloads at the same time. Additionally it is now possible to
schedule a file download by right clicking the download column in the
file table and selecting &ldquo;Download from client&rdquo;.</p><p><figure><img src=downloading_file.png alt="Initiating file download in the VFS. Note multiple files can be scheduled at the same time, and the bottom details pane can be closed" class=captioned><figcaption>Initiating file download in the VFS. Note multiple files can be scheduled at the same time, and the bottom details pane can be closed</figcaption></figure></p><h3 id=hex-viewer-and-file-previewer-gui>Hex viewer and file previewer GUI</h3><p>In release 0.6.9 a new hex viewer was introduced. This viewer makes it
possible to quickly triage uploaded files from the GUI itself,
implementing some common features:</p><ol><li>The file can be viewed as a hex dump or a strings style output.</li><li>The viewer can go to an arbitrary offset within the file, or page
forward or backwards.</li><li>The viewer can search forward or backwards in the file for a
<code>Regular Expression</code>, <code>String</code>, or a <code>Hex String</code>.</li></ol><p>The hex viewer previewer is available for artifacts that define a
column of type <code>preview_uploads</code> including the <code>File Upload</code> table
within the flow GUI.</p><p><figure><img src=hex_viewer.png alt="The hex viewer UI can be used to quickly inspect an uploaded file" class=captioned><figcaption>The hex viewer UI can be used to quickly inspect an uploaded file</figcaption></figure></p><h3 id=artifact-pack-import-gui-improvements>Artifact pack import GUI improvements</h3><p>Velociraptor allows uploading an <code>artifact pack</code> - a simple Zip file
containing artifact definitions. For example, the artifact exchange is
simply a zip file with artifact definitions.</p><p>Previously artifact packs could only be uploaded in their entirety and
always had an &ldquo;Exchange&rdquo; prefix prepended. However in this release the
UI was revamped to allow only some artifacts to be imported from the
pack and customize the prefix.</p><p><figure><img src=import_pack.png alt="It is now possible to import only some of the artifacts in a pack" class=captioned><figcaption>It is now possible to import only some of the artifacts in a pack</figcaption></figure></p><h2 id=direct-smb-support>Direct SMB support</h2><p>Windows file sharing is implemented over the SMB protocol. Within the
OS, accessing remote file shares happens transparently, for example by
mapping the remote share to a drive using <code>net use</code> command or
accessing a file name starting with a UNC path
(e.g. <code>\\ServerName\Share\File.exe</code>).</p><p>While Velociraptor can technically also access UNC shares by using the
usual file APIs and providing a UNC path, in reality this does not
work because Velociraptor is running as the local <code>System</code> user which
normally does not have network credentials so it can not map remote
shares.</p><p>This limitation is problematic because sometimes we need to access
remote shares (e.g. to verify hashes, perform yara scans etc). Until
this release the only workaround for this limitation was to install
the Velociraptor user as a domain user account with credentials.</p><p>As of the 0.6.9 release SMB is supported directly within the
Velociraptor binary as an accessor. This means that all plugins that
normally operate on files can also operate on a remote SMB share
transparently. Velociraptor does not rely on the OS to provide
credentials to the remote share, instead credentials can be passed
directly to the <code>smb</code> accessor to access the relevant <code>smb</code> server.</p><p>The new accessor can be used in any VQL that needs to use a file, but
to make it easier there is a new artifact called the
<code>Windows.Search.SMBFileFinder</code> artifact that allows for flexible file
searches on an SMB share.</p><p><figure><img src=smb_file_search.png alt="Searching a remote SMB share" class=captioned><figcaption>Searching a remote SMB share</figcaption></figure></p><h3 id=using-smb-for-distributing-tools>Using SMB for distributing tools</h3><p>Velociraptor can manage third party tools within its collected
artifacts by instructing the endpoint to download the tool from an
external server or the velociraptor server itself.</p><p>It is sometimes convenient to download external tools from an external
server (e.g. a cloud bucket) due to bandwidth considerations.</p><p>Previously this server could only be a HTTP server, but in many
deployments it is actually simpler to download external tools from an
SMB share.</p><p>In this release Velociraptor accepts an SMB URL as the serve URL
parameter within the tool configuration screen.</p><p><figure><img src=tool_serving_by_smb.png alt="Serving a third party tool from an SMB server" class=captioned><figcaption>Serving a third party tool from an SMB server</figcaption></figure></p><p>You can configure the remote share with read only permissions (read
<a href=/docs/offline_triage/remote_uploads/#smb-share>these instructions</a> for more details
on configuring SMB).</p><h2 id=the-offline-collector>The offline collector</h2><p>The offline collector is a popular mode of running Velociraptor, where
the artifacts to collect are pre-programmed into the collector which
stores the results in a zip file. The offline collector can be
pre-configured to encrypt and upload the collection automatically to
a remote server without user interaction, making it ideal for using
remote agents or people to manually run the collector without needing
further training.</p><p>In this release the Velociraptor offline collector added two more
upload targets. It is now possible to upload to an SMB server and to
Azure Blob Storage.</p><h3 id=smb-server-uploads>SMB server uploads</h3><p>Because the offline collector is typically used to collect large
volumes of data, it is beneficial to upload the data to a networked
server close to the collected machine. This avoids cloud network costs
and bandwidth limitations and works very well in air gapped networks.</p><p>You can now simply create a new share on any machine, by adding a
local Windows user with password credentials, exporting a directory as
a share and adjusting the upload user&rsquo;s permissions to only be able to
write on the share and not read from it. It is now safe to embed these
credentials in the offline collector - which can only upload data but
not read or delete other data.</p><p>See the full instructions of how to <a href=/docs/offline_triage/remote_uploads/#smb-share>configure the offline collector for SMB upload</a>.</p><h3 id=azure-blob-storage-service>Azure Blob storage service.</h3><p>Velociraptor can also upload collections to an Amazon S3 or Google
Cloud Storage bucket. However until now, Velociraptor did not support
the Azure offering. Many users requested direct support for Azure blob
storage, which is now in 0.6.9.</p><p>See this for all <a href=/docs/offline_triage/remote_uploads/#azure-blob-storage>The details about how to configure Azure for safe
uploads</a>, but
similar to the other methods, credentials embedded in the offline
collector can only be used to upload data and not read or delete data
in the storage account.</p><h2 id=debugging-vql-queries>Debugging VQL queries</h2><p>One of the points of feedback we received from our annual user survey
was that although VQL is an extremely powerful language, users
struggled with debugging and understanding how the query
proceeds. Unlike a more traditional programming language
(e.g. Python), there is no debugger where users can pause execution
and inspect variables, or add print statements to see what data is
passed between parts of the query.</p><p>We took this feedback on board and in release 0.6.9 the <code>EXPLAIN</code>
keyword was introduced. The <code>EXPLAIN</code> keyword can be added before any
SELECT in the VQL statement to place that SELECT statement into
tracing mode.</p><p>As a recap the general syntax of the VQL statement is:</p><pre><code class=language-vql>SELECT vql_fun(X=1, Y=2), Foo, Bar
FROM plugin(A=1, B=2)
WHERE X = 1
</code></pre><p>When a query is in tracing mode:</p><ol><li>All rows emitted from the plugin are logged with their types</li><li>All parameters into any function are also logged</li><li>When a row is filtered because it did not pass the <code>WHERE</code> clause this is also logged</li></ol><p>This additional tracing information can be used to understand how data
flows throughout the query.</p><p><figure><img src=explaining_a_query.png alt="Explaining a query reveals details information on how the VQL engine handles data flows" class=captioned><figcaption>Explaining a query reveals details information on how the VQL engine handles data flows</figcaption></figure></p><p>You can use the <code>EXPLAIN</code> statement in a notebook or within an
artifact as collected from the endpoint (although be aware that it can
lead to extremely verbose logging).</p><p><figure><img src=explaining_a_query_2.png alt="Inspect the details by clicking on the logs button" class=captioned><figcaption>Inspect the details by clicking on the logs button</figcaption></figure></p><p>For example in the above query we can see:</p><ol><li>The <code>clients()</code> plugin generates a row.</li><li>The <code>timestamp()</code> function received the <code>last_seen_at</code> value</li><li>The <code>WHERE</code> condition rejected the row because the <code>last_seen_at</code> time was more than 60 seconds ago.</li></ol><h2 id=locking-down-the-server>Locking down the server</h2><p>Another concern raised in our survey was the perceived risk of having
Velociraptor permanently installed. Due to its high privilege and
efficient scaling there is a risk that a Velociraptor administrator
account compromise can be escalated to compromise the entire domain.</p><p>While this risk is not higher than any other domain wide
administration tool, in some deployment scenarios, Velociraptor does
not need this level of access normally. While in an incident response
situation, it is necessary to promote Velociraptor&rsquo;s level of access
easily.</p><p>In the 0.6.9 release, Velociraptor has introduced <code>lock down mode</code>. When a server is locked down certain permissions are removed
(even from administrators). The lockdown is set in the config file,
helping to mitigate the risk of a Velociraptor server admin account
compromise.</p><p>After initial deployment and configuration, the administrator can set
the server in lockdown by adding the following configuration
directive to the <code>server.config.yaml</code> and restarting the server:</p><pre><code class=language-yaml>lockdown: true
</code></pre><p>After the server is restarted the following permissions will be denied:</p><ul><li><code>ARTIFACT_WRITER</code></li><li><code>SERVER_ARTIFACT_WRITER</code></li><li><code>COLLECT_CLIENT</code></li><li><code>COLLECT_SERVER</code></li><li><code>EXECVE</code></li><li><code>SERVER_ADMIN</code></li><li><code>FILESYSTEM_WRITE</code></li><li><code>FILESYSTEM_READ</code></li><li><code>MACHINE_STATE</code></li></ul><p>Therefore it will still be possible to read existing collections, and
continue collecting client monitoring data but not edit artifacts or
start new hunts or collections.</p><p>During an active IR the server may be taken out of lockdown by
removing the directive from the configuration file and restarting the
service. Usually the configuration file is only writable by root and
the Velociraptor server process is running as a low privilege account
which can not write to the config file. This combination makes it
difficult for a compromised Velociraptor administrator account to
remove the lockdown and use Velociraptor as a lateral movement
vehicle.</p><h2 id=audit-events>Audit events</h2><p>Velociraptor maintains a number of log files over its operation,
normally stored in the <code>&lt;filestore>/logs</code> directory. While the logs
are rotated and separated into different levels, the most important
log type is the <code>audit</code> log which records auditable events. Within
Velociraptor <code>auditable events</code> are security critical events such as:</p><ul><li>Starting a new collections from a client</li><li>Creating a new hunt</li><li>Modifying an artifact</li><li>Updating the client monitoring configuration</li></ul><p>Previous versions of Velociraptor simply wrote those events to the
logging directory but this can be deleted if the server becomes
compromised.</p><p>In 0.6.9 there are two ways to forward auditable events off the server</p><ol><li>Using <a href=/docs/deployment/references/#Logging.remote_syslog_server>remote syslog services</a></li><li>Uploading to external log management systems e.g. Opensearch/Elastic using the <a href=/artifact_references/pages/elastic.events.upload/>Elastic.Events.Upload</a> artifact.</li></ol><p>Additionally, auditable events are now emitted as part of the
<code>Server.Audit.Logs</code> artifact so they can be viewed or searched in the
GUI by any user.</p><p><figure><img src=inspecting_audit_log.png alt="The server&amp;rsquo;s audit log is linked from the Welcome page" class=captioned><figcaption>The server&amp;rsquo;s audit log is linked from the Welcome page</figcaption></figure></p><p><figure><img src=inspecting_audit_log_2.png alt="Inspecting user activity through the audit log" class=captioned><figcaption>Inspecting user activity through the audit log</figcaption></figure></p><p>Because audit events are available now as part of the server
monitoring artifact, it is possible for users to develop custom VQL
server monitoring artifacts to forward or respond to auditable events
just like any other event on the client or the server. This makes it
possible to forward events (e.g. to Slack or Discord) as demonstrated
by the <code>Elastic.Events.Upload</code> artifact above.</p><h2 id=tool-definitions-can-now-specify-an-expected-hash>Tool definitions can now specify an expected hash</h2><p>Velociraptor supports pushing tools to external endpoints. A
Velociraptor artifact can define an external tool, allowing the server
to automatically fetch the tool and upload it to the endpoint.</p><p>Previously the artifact could only specify the URL where the tool
should be downloaded from. However in this release it is also possible
to declare the expected hash of the tool. This prevents potential
substitution attacks effectively by pinning the third-party binary
hash.</p><p>While sometimes the upstream file may legitimately change (e.g. due to
a patch), Velociraptor will not automatically accept the new file when
the hash does not match the expected hash.</p><p><figure><img src=tool_hash_mismatch.png alt="Mismatched hash" class=captioned><figcaption>Mismatched hash</figcaption></figure></p><p>In the above I modified the expected hash to be slightly different
from the real tool hash. Velociraptor refuses to import the binary but
provides a button allowing the user to accept this new hash
instead. This should only be done if the administrator is convinced
the tool hash was legitimately updated.</p><h2 id=conclusions>Conclusions</h2><p>There are many more new features and bug fixes in the latest
release.</p><p>If you like the new features, take <a href=https://github.com/Velocidex/velociraptor>Velociraptor for a
spin</a>! It is available
on GitHub under an open source license. As always please file issues
on the bug tracker or ask questions on our mailing list
<a href=mailto:velociraptor-discuss@googlegroups.com>velociraptor-discuss@googlegroups.com</a>
. You can also chat with us directly on discord
<a href=https://www.velocidex.com/discord>https://www.velocidex.com/discord</a>
.</p><p>If you want to master Velociraptor, consider joining us at the full
Velociraptor training course held this year at the Blackhat
Conference and delivered by the Velociraptor developers themselves.</p><p>Details here:
<a href=https://docs.velociraptor.app/announcements/2023-trainings/>https://docs.velociraptor.app/announcements/2023-trainings/</a></p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1686138977></script>
<script src=/js/perfect-scrollbar.min.js?1686138977></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1686138977></script>
<script src=/js/jquery.sticky.js?1686138977></script>
<script src=/js/featherlight.min.js?1686138977></script>
<script src=/js/highlight.min.js?1686138977></script>
<script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1686138977></script>
<script src=/js/learn.js?1686138977></script>
<script src=/js/hugo-learn.js?1686138977></script></body></html>